(function($){$.util.namespace("$.fn.dialog.extensions");$.util.namespace("$.easyui");$.easyui.showDialog=function(options){var opts=$.extend({},$.easyui.showDialog.defaults,options||{});var currentFrame=arguments[1]?arguments[1]:$.util.currentFrame;if(opts.topMost&&$.easyui.showDialog.ntopSelf()){return $.util.$.easyui.showDialog(opts,currentFrame)}if(!opts.onApply){opts.onApply=opts.onSave}if(!opts.onSave){opts.onSave=opts.onApply}var onBeforeClose=opts.onBeforeClose,onClose=opts.onClose,onBeforeDestroy=opts.onBeforeDestroy;opts.onBeforeClose=function(){if(opts.closeAnimation&&opts.shadow){var shadow=$(this).dialog("shadow");if(shadow){shadow.hide()}}var ret=$.isFunction(onBeforeClose)?onBeforeClose.apply(this,arguments):undefined;return $.isFunction($.fn.dialog.defaults.onBeforeClose)&&$.fn.dialog.defaults.onBeforeClose.apply(this,arguments)==false?false:ret};opts.onClose=function(){if($.isFunction(onClose)){onClose.apply(this,arguments)}if($.isFunction($.fn.dialog.defaults.onClose)){$.fn.dialog.defaults.onClose.apply(this,arguments)}if(opts.autoDestroy){$(this).dialog("destroy")}};opts.onBeforeDestroy=function(){if(opts.iniframe){var iframe=$(this).dialog("iframe");removeFromCache(iframe[0])}var ret=$.isFunction(onBeforeDestroy)?onBeforeDestroy.apply(this,arguments):undefined;return $.isFunction($.fn.dialog.defaults.onBeforeDestroy)&&$.fn.dialog.defaults.onBeforeDestroy.apply(this,arguments)==false?false:ret};opts.closed=true;if(opts.locale){opts.inline=true}var t=$("<div></div>").appendTo(opts.locale?opts.locale:"body");if(!$.util.likeArray(opts.toolbar)){opts.toolbar=[]}if($.isArray(opts.toolbar)){$.each(opts.toolbar,function(){var handler=this.handler;if($.isFunction(handler)){this.handler=function(){handler.call(t,t)}}});if(!opts.toolbar.length){opts.toolbar=null}}var save={id:$.util.guid("N")+"_save",text:opts.saveButtonText,iconCls:opts.saveButtonIconCls,index:opts.saveButtonIndex,hidden:opts.enableSaveButton?false:true,handler:function(dia){var isFunc=$.isFunction(opts.onSave);if(!isFunc||isFunc&&opts.onSave.call(this,dia)!==false){$.util.delay(function(){dia.dialog("close")})}}},close={id:$.util.guid("N")+"_close",text:opts.closeButtonText,iconCls:opts.closeButtonIconCls,index:opts.closeButtonIndex,hidden:opts.enableCloseButton?false:true,handler:function(dia){$(dia).dialog("close")}},apply={id:$.util.guid("N")+"_apply",text:opts.applyButtonText,iconCls:opts.applyButtonIconCls,index:opts.applyButtonIndex,hidden:opts.enableApplyButton?false:true,handler:function(dia){if($.isFunction(opts.onApply)&&opts.onApply.call(this,dia)==false){return false}}},buttons=[save,close,apply];opts.buttons=$.isArray(opts.buttons)?$.array.map(opts.buttons,function(val){return $.extend({},val)}):[];$.array.merge(opts.buttons,buttons);opts.buttons=$.array.filter(opts.buttons,function(val){return $.util.parseFunction(val.hidden,[val])?false:true});$.each(opts.buttons,function(index,btn){var handler=btn.handler;if($.isFunction(handler)){btn.handler=function(){handler.call(this,t)}}});if(opts.buttons.length){$.array.sort(opts.buttons,function(a,b){return($.isNumeric(a.index)?a.index:0)-($.isNumeric(b.index)?b.index:0)})}else{opts.buttons=null}var topts,btns,toolbuttons;if(!opts.iniframe&&opts.href){var onBeforeLoad=opts.onBeforeLoad||$.fn.dialog.defaults.onBeforeLoad,onLoad=opts.onLoad||$.fn.dialog.defaults.onLoad;opts.onBeforeLoad=function(param){if($.isFunction(onBeforeLoad)){onBeforeLoad.apply(this,arguments)}btns.linkbutton("disable");toolbuttons.attr("disabled","disabled");topts.onBeforeLoad=onBeforeLoad};opts.onLoad=function(){if($.isFunction(onLoad)){onLoad.apply(this,arguments)}btns.linkbutton("enable");toolbuttons.removeAttr("disabled");topts.onLoad=onLoad}}topts=t.dialog(opts).dialog("options");var state=$.data(t[0],"dialog"),dialog=t.dialog("dialog"),iframe=t.dialog("iframe"),buttonbar=dialog.children(".dialog-button");btns=buttonbar.children("a");toolbuttons=t.dialog("header").find(".panel-tool a");var closeButton=btns.filter("#"+close.id),saveButton=btns.filter("#"+save.id),applyButton=btns.filter("#"+apply.id);save.target=saveButton[0];close.target=closeButton[0];apply.target=applyButton[0];if(iframe.length){$.easyui.showDialog.caches.push({current:iframe[0],parent:currentFrame})}$.extend(state,{saveButton:save,closeButton:close,applyButton:apply,save:function(){save.handler.call(save.target,t)},close:function(){close.handler.call(close.target,t)},apply:function(){apply.handler.call(apply.target,t)}});$.extend(t,{state:state,saveButton:save,closeButton:close,applyButton:apply,save:state.save,close:state.close,apply:state.apply});t.dialog("open");return t};function removeFromCache(iframe){var array=$.array.filter($.easyui.showDialog.caches,function(val){return val.current==iframe}),i=array.length;while(i--){$.array.remove($.easyui.showDialog.caches,array[i])}}function getDialogParent(){var current=$.util.currentFrame;if(!current){return $.util.top}var p=$.array.first($.easyui.showDialog.caches,function(val){return val.current==current});return p&&p.parent&&p.parent.contentWindow?p.parent.contentWindow:$.util.parent}$.easyui.showDialog.ntop=!$.util.isUtilTop&&$.util.$.easyui&&$.util.$.easyui.showDialog?true:false;$.easyui.showDialog.ntopSelf=function(){return!$.util.isUtilTop&&$.util.$.easyui&&$.util.$.easyui.showDialog};$.easyui.showDialog.caches=$.easyui.showDialog.ntopSelf()&&$.util.$.easyui.showDialog.caches?$.util.$.easyui.showDialog.caches:[];$.easyui.showDialog.parent=$.easyui.dialogParent=getDialogParent();$.easyui.showDialog.close=$.easyui.dialogParent.closeDialog=$.easyui.closeCurrentDialog=function(){if($.util.isUtilTop){return}if($.easyui.showDialog.parent&&$.easyui.showDialog.parent.$){var currentFrame=$.util.currentFrame;$.easyui.showDialog.parent.$(currentFrame).closest("div.window-body").dialog("close")}};$.easyui.showDialog.defaults={title:"新建对话框",iconCls:"icon-standard-application-form",width:600,height:360,modal:true,collapsible:false,maximizable:false,closable:true,draggable:true,resizable:true,shadow:true,minimizable:false,toolbar:null,buttons:null,href:null,hcenter:true,vcenter:true,autoDestroy:true,locale:null,topMost:false,iniframe:false,enableSaveButton:true,enableApplyButton:true,enableCloseButton:true,saveButtonIndex:101,closeButtonIndex:102,applyButtonIndex:100,onSave:null,onApply:null,onClose:null,saveButtonText:"确定",closeButtonText:"取消",applyButtonText:"保存&新建",saveButtonIconCls:"icon-save",applyButtonIconCls:"icon-savenew",closeButtonIconCls:"icon-cancel",buttonsPlain:false};var defaults=$.fn.dialog.extensions.defaults=$.extend({},$.fn.window.extensions.defaults,$.fn.panel.extensions.defaults,{});$.extend($.fn.dialog.defaults,defaults)})(jQuery);
