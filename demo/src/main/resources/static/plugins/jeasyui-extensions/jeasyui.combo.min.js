(function($,undefined){$.fn.combo.extensions={};function setPrompt(target,prompt){var t=$(target),opts=t.combo("options"),textbox=t.combo("textbox");opts.prompt=prompt;textbox.validatebox("setPrompt",prompt)}function setIcon(target,iconCls){var t=$(target),state=$.data(target,"combo"),combo=state.combo;var arrow=combo.find("span.combo-arrow").removeAttr("class").addClass("combo-arrow");if(iconCls){arrow.addClass(iconCls)}t.combo("options").iconCls=iconCls}function setRequired(target,required){var t=$(target),opts=t.combo("options"),textbox=t.combo("textbox");opts.required=textbox.validatebox("options").required=required}var _destroy=$.fn.combo.methods.destroy;function destroy(target){var t=$(target),opts=t.combo("options");if($.isFunction(opts.onBeforeDestroy)&&opts.onBeforeDestroy.call(target)==false){return}_destroy.call(target,t);if($.isFunction(opts.onDestroy)){opts.onDestroy.call(target)}}function getCombo(target){return $.data(target,"combo").combo}var _setValues=$.fn.combo.methods.setValues;function setValues(target,values){var t=$(target),opts=t.combo("options");if(!opts.nullable&&$.array.isNullOrEmpty(values)){values=[null]}return _setValues.call(t,t,values)}function clear(target){var state=$.data(target,"combo"),opts=state.options,combo=state.combo;if(opts.multiple){combo.find("input.combo-value"+(opts.nullable?"":":gt(0)")).remove()}combo.find("input.combo-value,input.combo-text").val("")}function initialize(target){var t=$(target),state=$.data(target,"combo"),opts=t.combo("options"),panel=state.panel,combo=state.combo,exts=opts.extensions?opts.extensions:opts.extensions={};if(!exts._initialized){t.combo("textbox").focus(function(){if(opts.autoShowPanel&&panel.is(":hidden")){t.combo("showPanel")}});if(opts.iconCls){t.combo("setIcon",opts.iconCls)}if($.util.browser.msie&&combo._outerWidth()!=opts.width){$.util.delay(function(){t.combo("resize",opts.width)})}exts._initialized=true}}var _combo=$.fn.combo;$.fn.combo=function(options,param){if(typeof options=="string"){return _combo.apply(this,arguments)}options=options||{};return this.each(function(){var jq=$(this),hasInit=$.data(this,"combo")?true:false,opts=hasInit?options:$.extend({},$.fn.combo.parseOptions(this),$.parser.parseOptions(this,["iconCls",{autoShowPanel:"boolean"}]),options);_combo.call(jq,opts);initialize(this)})};$.union($.fn.combo,_combo);var defaults=$.fn.combo.extensions.defaults={iconCls:null,autoShowPanel:true,nullable:true,onBeforeDestroy:function(){},onDestroy:function(){}};var methods=$.fn.combo.extensions.methods={setIcon:function(jq,iconCls){return jq.each(function(){setIcon(this,iconCls)})},setRequired:function(jq,required){return jq.each(function(){setRequired(this,required)})},setPrompt:function(jq,prompt){return jq.each(function(){setPrompt(this,prompt)})},destroy:function(jq){return jq.each(function(){destroy(this)})},combo:function(jq){return getCombo(jq[0])},setValues:function(jq,values){return jq.each(function(){setValues(this,values)})},clear:function(jq){return jq.each(function(){clear(this)})}};$.extend($.fn.combo.defaults,defaults);$.extend($.fn.combo.methods,methods);$.easyui.bindPageNestedFunc("mousedown","jdirkCombo","combo",function(win,e){var jq=win.jQuery,p=jq(e.target).closest("span.combo,div.combo-p");if(p.length){jq(p).find(".combo-f").each(function(){var panel=jq(this).combo("panel");if(panel.is(":visible")){panel.panel("close")}});if(e.target&&e.target.ownerDocument==win.document){return}}jq("body>div.combo-p>div.combo-panel:visible").panel("close")})})(jQuery);
