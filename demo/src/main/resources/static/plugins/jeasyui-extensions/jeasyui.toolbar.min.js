(function($){function initialize(target){var t=$(target),isDiv=/^(?:div)$/i.test(target.nodeName),cc=t.children(),toolbar=isDiv?t:$("<div></div>").insertAfter(t).append(t);if(!isDiv){toolbar.attr({class:t.attr("class"),style:t.attr("style")}).removeClass("easyui-toolbar");t.children().each(function(){toolbar.append(this)});t.hide()}var state=$.data(target,"toolbar"),opts=state.options;state.toolbar=toolbar.addClass("dialog-toolbar toolbar");t.addClass("toolbar-f");state.wrapper=$("<table class='toolbar-wrapper' cellspacing='0' cellpadding='0' ></table>").appendTo(toolbar);appendItem(target,cc);setSize(target,{width:opts.width,height:opts.height});toolbar.bind("_resize",function(){setSize(target)})}function appendItem(target,item){if(!item){return}if($.array.likeArrayNotString(item)){if(item.length){$.each(item,function(i,n){appendItem(target,n)})}}else if($.isFunction(item)){appendItem(target,item.call(target),false)}else{appendItemOption(target,item)}}function appendItemOption(target,item){if(!item){return}var state=$.data(target,"toolbar"),tr=state.wrapper.find("tr:last");if(!tr.length){tr=$("<tr class='toolbar-row'></tr>").appendTo(state.wrapper)}var container=$("<td class='toolbar-item-container'></td>").appendTo(tr);appendItemToContainer(target,container,item)}function appendItemToContainer(target,container,item){var state=$.data(target,"toolbar"),opts=state.options;if($.util.isDOM(item)){var cell=$(item).addClass("toolbar-item").appendTo(container),text=cell.text();var isDivOrSpan=/^(?:div|span)$/i.test(cell[0].nodeName);if(isDivOrSpan&&$.array.contains(["-","—","|"],text)){cell.addClass("dialog-tool-separator").empty();$.data(cell[0],"toolbar-item-data",{actions:opts.itemTypes.separator,target:cell,options:{},type:"separator",container:container})}else{$.data(cell[0],"toolbar-item-data",{actions:null,target:cell,options:null,type:"custom",container:container})}}else if($.array.contains(["string","number","date"],$.type(item))){item=$.string.trim(item);if($.array.contains(["-","—","|"],item)){appendItemToContainer(target,container,{type:"separator"})}else if($.array.contains(["\\t","\\n"],item)){}else if($.string.isHtmlText(item)){$(item).each(function(){appendItemToContainer(target,container,this)})}else{appendItemToContainer(target,container,{type:"label",options:{text:item}})}}else{var itemOpts=$.extend({},opts.itemOptions,item||{}),actions=opts.itemTypes[itemOpts.type];if(!actions||!actions.init){return}var tItem=actions.init(container[0],$.extend({},itemOpts,itemOpts.options||{})).addClass("toolbar-item");if(itemOpts.id){tItem.attr("id",itemOpts.id)}if(itemOpts.name){tItem.attr("name",itemOpts.name)}if(itemOpts.cls){container.addClass(itemOpts.cls)}if(itemOpts.itemCls){tItem.addClass(itemOpts.itemCls)}if(itemOpts.style){container.css(itemOpts.style)}if(itemOpts.itemStyle){tItem.css(itemOpts.itemStyle)}if(itemOpts.width){container.css("width",itemOpts.width)}if(itemOpts.align){container.css("text-align",itemOpts.align)}if(itemOpts.htmlAttr){tItem.attr(itemOpts.htmlAttr)}$.data(tItem[0],"toolbar-item-data",{actions:actions,target:tItem,options:itemOpts.options,type:itemOpts.type,container:container})}}function setSize(target,size){var t=$(target),state=$.data(target,"toolbar"),toolbar=state.toolbar,opts=state.options;size=$.extend({width:opts.width,height:opts.height},size||{});toolbar.css({width:size.width,height:size.height});$.extend(opts,size);$.util.delay(function(){setAlign(target,opts.align);setValign(target,opts.valign)});opts.onResize.call(target,$.isNumeric(size.width)?size.width:toolbar.width(),$.isNumeric(size.height)?size.height:toolbar.height())}function setAlign(target,align){align=String(align);if(!$.array.contains(["left","center","right"],align.toLowerCase())){return}var t=$(target),state=$.data(target,"toolbar"),wrapper=state.wrapper,opts=state.options,left=0;opts.align=align;wrapper.removeClass("toolbar-align-left toolbar-align-center toolbar-align-right").addClass("toolbar-align-"+align)}function setValign(target,valign){valign=String(valign);if(!$.array.contains(["top","middle","bottom"],valign.toLowerCase())){return}var t=$(target),state=$.data(target,"toolbar"),toolbar=state.toolbar,wrapper=state.wrapper,opts=state.options,outerHeight=toolbar.height(),height=wrapper.height(),top;opts.valign=valign;wrapper.removeClass("toolbar-valign-top toolbar-valign-middle toolbar-valign-bottom").addClass("toolbar-valign-"+valign);switch(valign){case"top":top=0;break;case"middle":top=(outerHeight-height)/2;break;case"bottom":top=outerHeight-height;break}wrapper.css("top",Math.max(top,0))}function getItems(target){var ret=[],t=$(target),wrapper=t.toolbar("wrapper");wrapper.find("tr:last>td.toolbar-item-container .toolbar-item").each(function(){var item=$.data(this,"toolbar-item-data");if(item){ret.push(item)}});return ret}function getValues(target,param){return $(target).serializeObject(param)}function enable(target){var items=getItems(target);$.each(items,function(i,item){if(item.actions&&$.isFunction(item.actions.enable)){item.actions.enable(item.target[0])}})}function disable(target){var items=getItems(target);$.each(items,function(i,item){if(item.actions&&$.isFunction(item.actions.disable)){item.actions.disable(item.target[0])}})}function loadData(target,data){var state=$.data(target,"toolbar"),opts=state.options;state.data=opts.loadFilter.call(target,data);state.wrapper.empty();appendItem(target,state.data);opts.onLoadSuccess.call(target,data)}function getData(target){return $.data(target,"toolbar").data}var itemOptions={id:null,name:null,type:"button",options:null,cls:null,style:null,itemCls:null,itemStyle:null,width:null,align:null,htmlAttr:null};var itemTypes={separator:{init:function(container){return $("<div class='dialog-tool-separator'></div>").appendTo(container)}},label:{defaults:{text:" "},init:function(container,options){var opts=$.extend({},this.defaults,options||{});var label=$("<span class='toolbar-item-label'></span>").text(opts.text).appendTo(container);if(opts.disabled){if($.isFunction(opts.disabled)){this[opts.disabled.call(label[0],$(container).closest("table.toolbar-wrapper")[0])?"disable":"enable"](label[0])}else{this[opts.disabled?"disable":"enable"](label[0])}}return label},enable:function(target){$(target).removeClass("toolbar-item-label-disabled")},disable:function(target){$(target).addClass("toolbar-item-label-disabled")}},text:{defaults:{value:null,disabled:false,width:null},init:function(container,options){var opts=$.extend({},this.defaults,options||{});var prop={};if(opts.id){prop.id=opts.id;prop.name=opts.id}if(opts.name){prop.name=opts.name}var box=$("<input type='text' class='toolbar-item-input' />").attr(prop).appendTo(container);if(opts.value){this.setValue(box[0],opts.value)}if(opts.disabled){if($.isFunction(opts.disabled)){this[opts.disabled.call(box[0],$(container).closest("table.toolbar-wrapper")[0])?"disable":"enable"](box[0])}else{this[opts.disabled?"disable":"enable"](box[0])}}if(opts.width){this.resize(box[0],opts.width)}var keydown=opts.keydown;if(keydown){keydown=$.string.toFunction(keydown)}if($.isFunction(keydown)){box.bind("keydown",function(event){keydown.call(this,event,$(container).closest("table.toolbar-wrapper")[0])})}return box},setValue:function(target,value){$(target).val(value)},getValue:function(target){return $(target).val()},resize:function(target,width){$(target)._outerWidth(width)},enable:function(target){$(target).removeAttr("disabled")},disable:function(target){$(target).attr("disabled",true)}},checkbox:{defaults:{checked:false,disabled:false,text:" "},init:function(container,options){options=options||{};var opts=$.extend({},this.defaults,$.util.isString(options)?{text:options}:options);var prop={};if(opts.id){prop.id=opts.id;prop.name=opts.id}if(opts.name){prop.name=opts.name}var label=$("<label class='toolbar-item-checkbox'></label>").appendTo(container),box=$("<input type='checkbox' class='toolbar-item-checkbox-input' />").attr(prop).appendTo(label),span=$("<span class='toolbar-item-checkbox-text'></span>").text(opts.text).appendTo(label);if(opts.checked){this.setValue(box[0],opts.checked)}if(opts.disabled){if($.isFunction(opts.disabled)){this[opts.disabled.call(box[0],$(container).closest("table.toolbar-wrapper")[0])?"disable":"enable"](box[0])}else{this[opts.disabled?"disable":"enable"](box[0])}}return box},setValue:function(target,value){$(target).attr("checked",value?true:false)},getValue:function(target){return $(target)[0].checked},enable:function(target){$(target).removeAttr("disabled").parent().find(">span.toolbar-item-checkbox-text").removeClass("toolbar-item-checkbox-disabled")},disable:function(target){$(target).attr("disabled",true).parent().find(">span.toolbar-item-checkbox-text").addClass("toolbar-item-checkbox-disabled")}},button:{defaults:{plain:true,iconCls:"icon-ok"},init:function(container,options){var opts=$.extend({},this.defaults,options||{});var prop={};if(opts.id){prop.id=opts.id}var handler=opts.onclick||opts.handler,btn=$("<a class='toolbar-item-button'></a>").attr(prop).appendTo(container);if(handler){handler=$.string.toFunction(handler)}if(opts.disabled&&$.isFunction(opts.disabled)){opts.disabled=opts.disabled.call(btn[0],$(container).closest("table.toolbar-wrapper")[0])}$.fn.toolbar.dealItemOptions(opts);return btn.linkbutton($.extend(opts,{onClick:function(){if($.isFunction(handler)){handler.call(this,$(container).closest("table.toolbar-wrapper")[0])}}}))},enable:function(target){$(target).linkbutton("enable")},disable:function(target){$(target).linkbutton("disable")}},validatebox:{defaults:{value:null,disabled:false,width:null},init:function(container,options){var opts=$.extend({},this.defaults,options||{});var prop={};if(opts.id){prop.id=opts.id;prop.name=opts.id}if(opts.name){prop.name=opts.name}$.fn.toolbar.dealItemOptions(opts);var box=$("<input type='text' class='toolbar-item-input' />").attr(prop).appendTo(container).validatebox(opts);if(opts.value){this.setValue(box[0],opts.value)}if($.isFunction(opts.disabled)){opts.disabled=opts.disabled.call(box[0],$(container).closest("table.toolbar-wrapper")[0])}if(opts.disabled){this.disable(box[0])}if(opts.width){this.resize(box[0],opts.width)}var keydown=opts.keydown;if(keydown){keydown=$.string.toFunction(keydown)}if($.isFunction(keydown)){box.bind("keydown",function(event){keydown.call(this,event,$(container).closest("table.toolbar-wrapper")[0])})}return box},setValue:function(target,value){$(target).val(value)},getValue:function(target){return $(target).val()},resize:function(target,width){$(target)._outerWidth(width)},enable:function(target){$(target).removeAttr("disabled")},disable:function(target){$(target).attr("disabled",true)}},textbox:{defaults:{width:null,type:"text",multiline:false},init:function(container,options){var opts=$.extend({},this.defaults,options||{},{type:options.options&&options.options.type?options.options.type:this.defaults.type});var prop={};if(opts.id){prop.id=opts.id;prop.name=opts.id}if(opts.name){prop.name=opts.name}var box=$("<input type='text' class='toolbar-item-input' />").attr(prop).appendTo(container);if($.isFunction(opts.disabled)){opts.disabled=opts.disabled.call(box[0],$(container).closest("table.toolbar-wrapper")[0])}$.fn.toolbar.dealItemOptions(opts);box.textbox(opts);var keydown=opts.keydown;if(keydown){keydown=$.string.toFunction(keydown)}if($.isFunction(keydown)){var tb=box.textbox("textbox");tb.bind("keydown",function(event){keydown.call(this,event,$(container).closest("table.toolbar-wrapper")[0])})}return box},destroy:function(target){$(target).textbox("destroy")},setValue:function(target,value){$(target).textbox("setValue",value)},getValue:function(target){return $(target).textbox("getValue")},resize:function(target,width){$(target).textbox("resize",width)},enable:function(target){$(target).textbox("enable")},disable:function(target){$(target).textbox("disable")}},numberbox:{defaults:{width:null},init:function(container,options){var opts=$.extend({},this.defaults,options||{},{type:"text"});var prop={};if(opts.id){prop.id=opts.id;prop.name=opts.id}if(opts.name){prop.name=opts.name}var box=$("<input type='text' class='toolbar-item-input' />").attr(prop).appendTo(container);if($.isFunction(opts.disabled)){opts.disabled=opts.disabled.call(box[0],$(container).closest("table.toolbar-wrapper")[0])}$.fn.toolbar.dealItemOptions(opts);box.numberbox(opts);var keydown=opts.keydown;if(keydown){keydown=$.string.toFunction(keydown)}if($.isFunction(keydown)){var tb=box.numberbox("textbox");tb.bind("keydown",function(event){keydown.call(this,event,$(container).closest("table.toolbar-wrapper")[0])})}return box},destroy:function(target){$(target).numberbox("destroy")},setValue:function(target,value){$(target).numberbox("setValue",value)},getValue:function(target){return $(target).numberbox("getValue")},resize:function(target,width){$(target)._outerWidth(width)},enable:function(target){$(target).numberbox("enable")},disable:function(target){$(target).numberbox("disable")}},numberspinner:{defaults:{},init:function(container,options){var opts=$.extend({},this.defaults,options||{},{type:"text"});var prop={};if(opts.id){prop.id=opts.id;prop.name=opts.id}if(opts.name){prop.name=opts.name}$.fn.toolbar.dealItemOptions(opts);var box=$("<input type='text' class='toolbar-item-input' />").attr(prop).appendTo(container).numberspinner(opts);return box},destroy:function(target){$(target).numberspinner("destroy")},setValue:function(target,value){$(target).numberspinner("setValue",value)},getValue:function(target){return $(target).numberspinner("getValue")},resize:function(target,width){$(target).numberspinner("resize",width)},enable:function(target){$(target).numberspinner("enable")},disable:function(target){$(target).numberspinner("disable")}},datebox:{defaults:{},init:function(container,options){var opts=$.extend({},this.defaults,options||{},{type:"text"});var prop={};if(opts.id){prop.id=opts.id;prop.name=opts.id}if(opts.name){prop.name=opts.name}var box=$("<input type='text' class='toolbar-item-input' />").attr(prop).appendTo(container);if($.isFunction(opts.disabled)){opts.disabled=opts.disabled.call(box[0],$(container).closest("table.toolbar-wrapper")[0])}$.fn.toolbar.dealItemOptions(opts);box.datebox(opts);return box},destroy:function(target){$(target).datebox("destroy")},setValue:function(target,value){$(target).datebox("setValue",value)},getValue:function(target){return $(target).datebox("getValue")},resize:function(target,width){$(target).datebox("resize",width)},enable:function(target){$(target).datebox("enable")},disable:function(target){$(target).datebox("disable")},setFocus:function(target){$(target).datebox("textbox").focus()}},datetimebox:{defaults:{},init:function(container,options){var opts=$.extend({},this.defaults,options||{},{type:"text"});var prop={};if(opts.id){prop.id=opts.id;prop.name=opts.id}if(opts.name){prop.name=opts.name}var box=$("<input type='text' class='toolbar-item-input' />").attr(prop).appendTo(container);if($.isFunction(opts.disabled)){opts.disabled=opts.disabled.call(box[0],$(container).closest("table.toolbar-wrapper")[0])}$.fn.toolbar.dealItemOptions(opts);box.datetimebox(opts);return box},destroy:function(target){$(target).datetimebox("destroy")},setValue:function(target,value){$(target).datetimebox("setValue",value)},getValue:function(target){return $(target).datetimebox("getValue")},resize:function(target,width){$(target).datetimebox("resize",width)},enable:function(target){$(target).datetimebox("enable")},disable:function(target){$(target).datetimebox("disable")},setFocus:function(target){$(target).datetimebox("textbox").focus()}},timespinner:{defaults:{},init:function(container,options){var opts=$.extend({},this.defaults,options||{},{type:"text"});var prop={};if(opts.id){prop.id=opts.id;prop.name=opts.id}if(opts.name){prop.name=opts.name}var box=$("<input type='text' class='toolbar-item-input' />").attr(prop).appendTo(container);if($.isFunction(opts.disabled)){opts.disabled=opts.disabled.call(box[0],$(container).closest("table.toolbar-wrapper")[0])}$.fn.toolbar.dealItemOptions(opts);box.timespinner(opts);return box},destroy:function(target){$(target).timespinner("destroy")},setValue:function(target,value){$(target).timespinner("setValue",value)},getValue:function(target){return $(target).timespinner("getValue")},resize:function(target,width){$(target).timespinner("resize",width)},enable:function(target){$(target).timespinner("enable")},disable:function(target){$(target).timespinner("disable")}},combo:{defaults:{},init:function(container,options){var opts=$.extend({},this.defaults,options||{},{type:"text"});var prop={};if(opts.id){prop.id=opts.id;prop.name=opts.id}if(opts.name){prop.name=opts.name}var box=$("<input type='text' class='toolbar-item-input' />").attr(prop).appendTo(container);if($.isFunction(opts.disabled)){opts.disabled=opts.disabled.call(box[0],$(container).closest("table.toolbar-wrapper")[0])}$.fn.toolbar.dealItemOptions(opts);box.combo(opts);return box},destroy:function(target){$(target).combo("destroy")},setValue:function(target,value){$(target).combo($.util.likeArrayNotString(value)?"setValues":"setValue",value)},getValue:function(target){var combo=$(target),opts=combo.combo("options");return $(target).combo(opts.multiples?"getValues":"getValue")},resize:function(target,width){$(target).combo("resize",width)},enable:function(target){$(target).combo("enable")},disable:function(target){$(target).combo("disable")},setFocus:function(target){$(target).combo("textbox").focus()}},combobox:{defaults:{},init:function(container,options){var opts=$.extend({},this.defaults,options||{},{type:"text"});var prop={};if(opts.id){prop.id=opts.id;prop.name=opts.id}if(opts.name){prop.name=opts.name}var box=$("<input type='text' class='toolbar-item-input' />").attr(prop).appendTo(container);if($.isFunction(opts.disabled)){opts.disabled=opts.disabled.call(box[0],$(container).closest("table.toolbar-wrapper")[0])}$.fn.toolbar.dealItemOptions(opts);box.combobox(opts);return box},destroy:function(target){$(target).combobox("destroy")},setValue:function(target,value){$(target).combobox($.util.likeArrayNotString(value)?"setValues":"setValue",value)},getValue:function(target){var combo=$(target),opts=combo.combobox("options");return $(target).combobox(opts.multiples?"getValues":"getValue")},resize:function(target,width){$(target).combobox("resize",width)},enable:function(target){$(target).combobox("enable")},disable:function(target){$(target).combobox("disable")},setFocus:function(target){$(target).combobox("textbox").focus()}},combotree:{defaults:{},init:function(container,options){var opts=$.extend({},this.defaults,options||{},{type:"text"});var prop={};if(opts.id){prop.id=opts.id;prop.name=opts.id}if(opts.name){prop.name=opts.name}var box=$("<input type='text' class='toolbar-item-input' />").attr(prop).appendTo(container);if($.isFunction(opts.disabled)){opts.disabled=opts.disabled.call(box[0],$(container).closest("table.toolbar-wrapper")[0])}$.fn.toolbar.dealItemOptions(opts);box.combotree(opts);return box},destroy:function(target){$(target).combotree("destroy")},setValue:function(target,value){$(target).combotree($.util.likeArrayNotString(value)?"setValues":"setValue",value)},getValue:function(target){var combo=$(target),opts=combo.combotree("options");return $(target).combotree(opts.multiples?"getValues":"getValue")},resize:function(target,width){$(target).combotree("resize",width)},enable:function(target){$(target).combotree("enable")},disable:function(target){$(target).combotree("disable")},setFocus:function(target){$(target).combotree("textbox").focus()}},combogrid:{defaults:{},init:function(container,options){var opts=$.extend({},this.defaults,options||{},{type:"text"});var prop={};if(opts.id){prop.id=opts.id;prop.name=opts.id}if(opts.name){prop.name=opts.name}var box=$("<input type='text' class='toolbar-item-input' />").attr(prop).appendTo(container);if($.isFunction(opts.disabled)){opts.disabled=opts.disabled.call(box[0],$(container).closest("table.toolbar-wrapper")[0])}if(opts.style==null){opts.style={}}$.fn.toolbar.dealItemOptions(opts);box.combogrid(opts);return box},destroy:function(target){$(target).combogrid("destroy")},setValue:function(target,value){$(target).combogrid($.util.likeArrayNotString(value)?"setValues":"setValue",value)},getValue:function(target){var combo=$(target),opts=combo.combogrid("options");return $(target).combogrid(opts.multiples?"getValues":"getValue")},resize:function(target,width){$(target).combogrid("resize",width)},enable:function(target){$(target).combogrid("enable")},disable:function(target){$(target).combogrid("disable")},setFocus:function(target){$(target).combogrid("textbox").focus()}},searchbox:{defaults:{},init:function(container,options){var opts=$.extend({},this.defaults,options||{},{type:"text"});var prop={};if(opts.id){prop.id=opts.id;prop.name=opts.id}if(opts.name){prop.name=opts.name}var box=$("<input type='text' class='toolbar-item-input' />").attr(prop).appendTo(container);if(opts.searcher){opts.searcher=$.string.toFunction(opts.searcher)}if($.isFunction(opts.disabled)){opts.disabled=opts.disabled.call(box[0],$(container).closest("table.toolbar-wrapper")[0])}$.fn.toolbar.dealItemOptions(opts);return box.searchbox(opts)},destroy:function(target){$(target).searchbox("destroy")},setValue:function(target,value){$(target).searchbox("setValue",value)},getValue:function(target){return $(target).searchbox("getValue")},resize:function(target,width){$(target).searchbox("resize",width)},enable:function(target){$(target).searchbox("enable")},disable:function(target){$(target).searchbox("disable")},setFocus:function(target){$(target).searchbox("textbox").focus()}}};itemTypes.linkbutton=itemTypes.button;var loader=function(param,success,error){var opts=$(this).toolbar("options");if(!opts.url){return false}$.ajax({type:opts.method,url:opts.url,data:param,dataType:"json",success:function(data){success(data)},error:function(){error.apply(this,arguments)}})},loadFilter=function(data){return $.array.likeArrayNotString(data)?data:[]};$.fn.toolbar=function(options,param){if(typeof options=="string"){return $.fn.toolbar.methods[options](this,param)}options=options||{};return this.each(function(){var state=$.data(this,"toolbar");if(state){$.extend(state.options,options)}else{state=$.data(this,"toolbar",{options:$.extend({},$.fn.toolbar.defaults,$.fn.toolbar.parseOptions(this),options)})}initialize(this);if(state.options.data){loadData(this,state.options.data)}})};$.fn.toolbar.parseOptions=function(target){return $.extend({},$.parser.parseOptions(target,["url","data","method","width","height","align","valign"]))};$.fn.toolbar.dealItemOptions=function(options){delete options.options;delete options.itemCls;delete options.itemStyle};$.fn.toolbar.methods={options:function(jq){return $.data(jq[0],"toolbar").options},wrapper:function(jq){return $.data(jq[0],"toolbar").wrapper},toolbar:function(jq){return $.data(jq[0],"toolbar").toolbar},resize:function(jq,size){return jq.each(function(){setSize(this,size)})},align:function(jq,align){return jq.each(function(){setAlign(this,align)})},valign:function(jq,valign){return jq.each(function(){setValign(this,valign)})},getItems:function(jq){return getItems(jq[0])},getValues:function(jq){return getValues(jq[0])},enable:function(jq){return jq.each(function(){enable(this)})},disable:function(jq){return jq.each(function(){disable(this)})},getData:function(jq){return getData(jq[0])},loadData:function(jq,data){return jq.each(function(){loadData(this,data)})}};$.fn.toolbar.defaults={width:"auto",height:"auto",align:"left",valign:"middle",data:null,itemOptions:itemOptions,itemTypes:itemTypes,onResize:function(width,height){},onLoadSuccess:function(data){},loadFilter:loadFilter};$.parser.plugins.push("toolbar")})(jQuery);
