(function($){$.util.namespace("$.fn.tabs.extensions");function getTabOption(target,which){var t=$(target),tab=t.tabs("getTab",which),tabOpts=tab.panel("options");return tabOpts}function getContextMenuItems(t,opts,e,title,index){var menuItems=[],defaultMenuItems=[],popts=getTabOption(t[0],index),args=[t[0],title,index];$.array.merge(defaultMenuItems,defaultMenuItems.length?"-":[],$.fn.tabs.extensions.closeTabsMenus);$.array.merge(defaultMenuItems,defaultMenuItems.length?"-":[],$.fn.tabs.extensions.closeOtherTabsMenus);if($.array.likeArrayNotString(opts.contextMenu)){$.array.merge(menuItems,menuItems.length?"-":[],opts.contextMenu)}if(defaultMenuItems.length){$.array.merge(menuItems,menuItems.length?"-":[],defaultMenuItems)}return $.easyui.parseMenuItems(menuItems,args)}$.fn.tabs.extensions.closeTabsMenus=[{text:"关闭选项卡",iconCls:"icon-standard-application-form-delete",disabled:function(e,menuItem,menu,target,title,index){return getTabOption(target,index).closable?false:true},handler:function(e,menuItem,menu,target,title,index){$(target).tabs("closeClosable",index)}},{text:"关闭其他选项卡",iconCls:"icon-standard-cancel",disabled:function(e,menuItem,menu,target,title,index){return $(target).tabs("otherClosableTabs",index).length?false:true},handler:function(e,menuItem,menu,target,title,index){$(target).tabs("closeOtherClosable",index)}}];$.fn.tabs.extensions.closeOtherTabsMenus=[{text:"关闭左侧选项卡",iconCls:"icon-standard-tab-close-left",disabled:function(e,menuItem,menu,target,title,index){return $(target).tabs("leftClosableTabs",index).length?false:true},handler:function(e,menuItem,menu,target,title,index){$(target).tabs("closeLeftClosable",index)}},{text:"关闭右侧选项卡",iconCls:"icon-standard-tab-close-right",disabled:function(e,menuItem,menu,target,title,index){return $(target).tabs("rightClosableTabs",index).length?false:true},handler:function(e,menuItem,menu,target,title,index){$(target).tabs("closeRightClosable",index)}},{text:"关闭所有选项卡",iconCls:"icon-standard-cross",disabled:function(e,menuItem,menu,target,title,index){return $(target).tabs("closableTabs").length?false:true},handler:function(e,menuItem,menu,target,title,index){$(target).tabs("closeAllClosable",index)}}];function initContextMenu(t,opts){t.children("div.tabs-header").unbind(".tabs-contextmenu").bind({"contextmenu.tabs-contextmenu":function(e){if(!opts.enableConextMenu){return}var li=$(e.target).closest("li");if(li.length&&!li.is(".tabs-disabled")){e.preventDefault();var title=li.find("span.tabs-title").html(),index=li.index(),menuItems=getContextMenuItems(t,opts,e,title,index);$.easyui.showMenu({items:menuItems,left:e.pageX,top:e.pageY,event:e})}},"click.tabs-contextmenu":function(e){$.easyui.hideAllMenu()}})}function initializeExtensions(target){var t=$(target),state=$.data(target,"tabs"),opts=state.options;initContextMenu(t,opts)}var _tabs=$.fn.tabs.extensions._tabs=$.fn.tabs;$.fn.tabs=function(options,param){if(typeof options=="string"){return _tabs.apply(this,arguments)}options=options||{};return this.each(function(){var jq=$(this),isInited=$.data(this,"tabs")?true:false,opts=isInited?options:$.extend({},$.fn.tabs.parseOptions(this),$.parser.parseOptions(this,[{enableConextMenu:"boolean"}]),options);_tabs.call(jq,opts,param);if(!isInited){initializeExtensions(this)}})};$.union($.fn.tabs,_tabs);var defaults=$.fn.tabs.extensions.defaults={enableConextMenu:true,contextMenu:null};var methods=$.fn.tabs.extensions.methods={};$.extend($.fn.tabs.defaults,defaults);$.extend($.fn.tabs.methods,methods)})(jQuery);
